'use strict'

const converter = require('./converter')
const runCommand = require('@antora/run-command-helper')

module.exports.register = function ({ config }, providers) {
  requireAssembler(this).configure(this, converter.bind(this, runCommand), config, providers)
}

function requireAssembler (context, packageName = '@antora/assembler') {
  try {
    return context.require(packageName) // when installed with Antora
  } catch {}
  return require(packageName) // when installed separate from Antora, perhaps in project
}
